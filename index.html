<!DOCTYPE html>
<html>
<head>
    <title></title>

    <!-- Mapbox -->

    <script src='https://api.tiles.mapbox.com/mapbox-gl-js/v0.44.0/mapbox-gl.js'></script>

    <link href='https://api.tiles.mapbox.com/mapbox-gl-js/v0.44.0/mapbox-gl.css' rel='stylesheet' />

</head>
<body>

<div id='map' style='width: 100%; height: 1080px;'></div>

<script>

    //Default coordinates of Lyon

    var userCoordinates = {

        userLatitude : 45.75717800533178,

        userLongitude : 4.83480298193669

    }

    getUserLocation();

    mapboxgl.accessToken = 'pk.eyJ1IjoiYWd0ZXJyYWwiLCJhIjoiY2pkMjRnbjJkNWYwZDJ4bGdwMWlxODJiYSJ9.4W9g-Go5vHpL9UZmjnGj4g';

    var map = new mapboxgl.Map({

        container: 'map',

        center: [ userCoordinates.userLongitude, userCoordinates.userLatitude ],

        zoom: 13,

        style: 'mapbox://styles/mapbox/streets-v9'

    });

    var userPositionMarker = new mapboxgl.Marker().setLngLat([userCoordinates.userLongitude, userCoordinates.userLatitude]).addTo(map);

    //Functions

    function getUserLocation()
    {

        if( navigator.geolocation )
        {

            navigator.geolocation.watchPosition(setUserCoordinates);

        }

    }

    function setUserCoordinates(position) {

        console.log("test");

        userCoordinates.userLatitude = position.coords.latitude;

        userCoordinates.userLongitude = position.coords.longitude;

        map.setCenter([userCoordinates.userLongitude, userCoordinates.userLatitude]);

        userPositionMarker.setLngLat([userCoordinates.userLongitude, userCoordinates.userLatitude]);

    }

    // Location by mapbox

 /*   map.addControl( new mapboxgl.GeolocateControl ({

        positionOptions: {

            enableHighAccuracy: true

        },

        trackUserLocation: true

    }));*/

</script>


</body>
</html>